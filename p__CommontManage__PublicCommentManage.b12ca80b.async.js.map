{"version":3,"sources":["webpack://windvane/./node_modules/@babel/runtime-corejs3/core-js/instance/trim.js","webpack://windvane/./src/components/QueryTable/index.less","webpack://windvane/./src/pages/CommontManage/PublicCommentManage/index.less","webpack://windvane/./src/components/FormRender.tsx","webpack://windvane/./src/components/QueryTable/index.tsx","webpack://windvane/./src/pages/CommontManage/PublicCommentManage/index.tsx","webpack://windvane/./node_modules/core-js-pure/es/instance/trim.js","webpack://windvane/./node_modules/core-js-pure/es/string/virtual/trim.js","webpack://windvane/./node_modules/core-js-pure/features/instance/trim.js","webpack://windvane/./node_modules/core-js-pure/internals/string-trim-forced.js","webpack://windvane/./node_modules/core-js-pure/modules/es.string.trim.js"],"names":["module","exports","trimString","objToTrim","fields","keyName","FormRender","props","ref","form","async","getValues","formValue","validateFields","useImperativeHandle","resetFrom","resetFields","getChildren","useCallback","renderCom","comProps","label","isValidElement","placeholder","onPressEnter","allowClear","onChange","options","item","value","showTime","style","width","ranges","moment","startOf","endOf","subtract","initialValues","gutter","items","span","name","formItemLayout","itemProps","forwardRef","labelCol","wrapperCol","QueryTable","formItem","columns","rowKey","plusAction","query","list","total","loading","defaultPageSize","pageSizeOptions","notQueryWhilestart","defaultRef","useRef","formRef","undefined","defaultStep","Number","defaultPaginetionInfo","current","pageSize","useState","paginationInfo","setpaginationInfo","sortColumns","setsortColumns","search","pageInfoParams","sorter","values","sendSorter","formatParams","getRequestParams","length","order","paramsCurrent","paramsPageSize","rest","requestParams","pagination","sort","type","key","field","error","console","handleReset","useEffect","paginationOnChange","tableChange","filters","className","styles","onClick","marginRight","children","bordered","size","dataSource","showTotal","totalCount","showSizeChanger","PAGESIZE","COMMENT_USER_RANK","PublicCommentManage","productionId","location","dramaId","initSearch","subjectId","commentUserRank","checkStatus","rootId","searchParams","setSearchParams","useGetCommontList","commontList","CommontCount","isValidating","mutate","isHighQuality","queryTable","productionIds","useMemo","subjectType","useGetProductionGroupDetail","productionGroupDetail","handleChangeSearch","detailLoading","CommentStatusMaps","isGoodCommentMaps","subjectTypeMaps","SortOptionsMaps","handleSearch","params","page","log","title","filmTitle","handleChangePage","lastestParams","hiddenAddPraise","pop","tip","spinning","index","showBlackBtn","showProductionName","common","refresh","showQuickJumper","withAuthorized","Role","trim","StringPrototype","String","prototype","it","own","entryVirtual","parent","fails","whitespaces","non","METHOD_NAME","$","$trim","forcedStringTrimMethod","target","proto","forced","this"],"mappings":"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","file":"p__CommontManage__PublicCommentManage.b12ca80b.async.js","sourcesContent":["module.exports = require(\"core-js-pure/features/instance/trim\");","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"_1pnNnm\",\"actions\":\"_23Utz2\",\"body\":\"_3euxaN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"footerPage\":\"_3Cp3MJ\"};","import React, { ForwardRefRenderFunction, useImperativeHandle, MutableRefObject, forwardRef, useCallback, ReactElement, isValidElement } from 'react';\nimport { Form, Row, Col, Input, Select, DatePicker } from 'antd';\nimport moment from 'moment';\n\n\ntype SupportRenderItem = 'input' | 'passwordInput' | 'select' | 'rangePicker' | 'datePicker'\n\ninterface ColType {\n  span: number;\n}\n\ninterface FormItemLayout {\n  labelCol: ColType;\n  wrapperCol: ColType;\n}\nexport interface FormItem {\n  name: string;\n  label: string;\n  renderCom: SupportRenderItem | ReactElement;\n  comProps?: {\n    options?: SelectOptions[];\n    placeholder?: string;\n    [key: string]: any;\n  };\n  span?: number;\n  itemProps?: { };\n}\n\nexport interface SelectOptions {\n  label: string | number;\n  value: string | number;\n}\n\n\nexport interface Props {\n  ref: MutableRefObject<any>;\n  items: FormItem[];\n  onPressEnter?: () => any;\n  initialValues?: {[keyName: string]: any};\n  formItemLayout: FormItemLayout;\n}\n\nfunction trimString(objToTrim: {[k: string]: any}) {\n  const fields = { ...objToTrim };\n\n  Object.keys({ ...fields }).forEach((keyName: string) => {\n    if (typeof fields[keyName] === 'string') {\n      fields[keyName] = fields[keyName].trim();\n    }\n  });\n\n  return fields;\n}\n\nconst FormRender: ForwardRefRenderFunction<unknown, Props> = (props: Props, ref: MutableRefObject<any>) => {\n  const [form] = Form.useForm();\n\n  async function getValues() {\n    const formValue = await form.validateFields();\n\n    return trimString(formValue);\n  }\n\n  useImperativeHandle(ref, () => ({\n    resetFrom: form.resetFields,\n    getValues,\n  })\n  );\n\n  const getChildren = useCallback(({ renderCom, comProps = {}, label }: FormItem) => {\n\n    if (isValidElement(renderCom)) {\n      return renderCom;\n    }\n    switch (renderCom) {\n      case 'input':\n        return <Input placeholder={ comProps?.placeholder ?? `请输入${ label }` } onPressEnter={ () => props.onPressEnter && props.onPressEnter() } />;\n      case 'passwordInput':\n        return <Input.Password placeholder={ comProps?.placeholder ?? `请输入${ label }` } onPressEnter={ () => props.onPressEnter && props.onPressEnter() } />;\n      case 'select':\n        return (\n          <Select {\n            ...{\n              allowClear: true,\n              placeholder: `请选择${ label }`,\n              onChange: () => props.onPressEnter && props.onPressEnter(),\n              ...comProps\n            } }>\n            {\n              comProps?.options?.map((item: SelectOptions) => (\n                <Select.Option value={ item.value } key={ item.value }>{item.label}</Select.Option>\n              ))\n            }\n          </Select>\n        );\n      case 'rangePicker':\n        return (\n          <DatePicker.RangePicker showTime={ true } style={{ width: '100%' }}\n            ranges={{\n              '今天': [moment().startOf('day'), moment().endOf('day')],\n              '昨天': [moment().startOf('day').subtract(1, 'day'), moment().endOf('day').subtract(1, 'day')],\n              '本周': [moment().startOf('week'), moment().endOf('week')],\n              '本月': [moment().startOf('month'), moment().endOf('month')]\n            }}\n            { ... comProps }\n          />);\n      case 'datePicker':\n        return (\n          <DatePicker style={{ width: '100%' }}\n            { ... comProps }\n          />);\n      default:\n        return <Input />;\n    }\n  }, [props.onPressEnter]);\n\n\n  return (\n    <Form form={ form }\n      initialValues={ props.initialValues }\n    >\n      <Row gutter={ 24 }>\n        {\n          props.items.map((item: FormItem) => {\n            return (\n              <Col span={ item.span ?? 8 } key={ item.name }>\n                <Form.Item name={ item.name } label={ item.label } { ...props.formItemLayout } { ...item.itemProps }>\n                  {\n                    getChildren(item)\n                  }\n                </Form.Item>\n              </Col>\n            );\n          } )\n        }\n      </Row>\n    </Form>\n  );\n};\n\n\nexport default forwardRef(FormRender);\n","import React, { useEffect, useRef, useState, useImperativeHandle, ReactElement, ForwardRefRenderFunction, MutableRefObject, forwardRef } from 'react';\nimport { Button, Table } from 'antd';\nimport { ColumnsType } from 'antd/lib/table';\nimport FormRender, { FormItem } from '../FormRender';\nimport styles from './index.less';\nimport { getRequestParams } from '@/utils/functions';\nimport { ListQueryRequestBody } from '@/types/types';\n\nexport type PageInfo = { current?: number; pageSize?: number }\nexport type OnSearch = { searchParam: {[keyname: string]: any}; pageInfo: PageInfo }\n\ninterface ColType {\n  span: number;\n}\n\ninterface FormItemLayout {\n  labelCol: ColType;\n  wrapperCol: ColType;\n}\n\ninterface KeyValue {\n  [key: string]: any;\n}\ninterface SortColumns {\n  field?: string;                               // key\n  order?: undefined | string;                   // 排序方式\n}\n\ninterface Pagination {\n  current: number;\n  pageSize: number;\n}\n\nexport interface Props {\n  formItem?: FormItem[];                        // FormRender的查询项配置\n  columns?: ColumnsType;                        // Table Columns\n  children?: ReactElement | ReactElement[];     // 默认QueryTable展示Table，如果传入children，则展示children\n  plusAction?: ReactElement | ReactElement[];   // 出查询和重置以外的按钮\n  initialValues?: KeyValue;                     // FormRender初始化数据\n  formRef?: MutableRefObject<any>;              // FormRender的ref\n  rowKey: string;                               // Table rowKey\n  formItemLayout?: FormItemLayout;              // FormItem的labelCol和wrapperCol\n  query: (params: KeyValue) => void;            // 查询函数\n  list: KeyValue[];                             // Table dataSource数据\n  total: number;                                // Table total总数据条数\n  loading: boolean;                             // 请求loading状态\n  defaultPageSize?: number;                     // 初始pagesize\n  pageSizeOptions?: string[];                   // 每页多少条数据\n  notQueryWhilestart?: boolean;                 // 首页进入页面是否查询\n}\n\nconst formItemLayout = {\n  labelCol: { span: 6 },\n  wrapperCol: { span: 18 }\n};\n\n\nconst QueryTable: ForwardRefRenderFunction<unknown, Props> = (\n  props: Props,\n  ref: MutableRefObject<any>,\n) => {\n  const {\n    formItem = [],\n    columns,\n    rowKey = 'key',\n    initialValues = {},\n    plusAction, query,\n    list = [],\n    total = 0,\n    loading,\n    defaultPageSize,\n    pageSizeOptions = ['10', '20', '50', '100'],\n    notQueryWhilestart\n  } = props;\n  const defaultRef = useRef<any>(null);\n  const formRef = props.formRef !== undefined ? props.formRef : defaultRef;\n  const defaultStep = defaultPageSize ?? Number(pageSizeOptions[0]); // 如果传值了，则取defaultPageSize, 否则取每页条数配置的第一项。\n  const defaultPaginetionInfo: Pagination = { current: 1, pageSize: defaultStep };\n  const [paginationInfo, setpaginationInfo] = useState(defaultPaginetionInfo);\n  const [sortColumns, setsortColumns] = useState<SortColumns | undefined>({}); // 排序\n  // 查询\n  const search = async (pageInfoParams?: PageInfo, sorter?: SortColumns) => {\n    try {\n      const values = await formRef.current?.getValues();\n      const { current, pageSize } = paginationInfo;\n      const sendSorter = sorter || sortColumns;\n\n      const formatParams: KeyValue = getRequestParams({\n        ...values,\n        ...{ current, pageSize },     // 如果当前请求没传页数和每页条数，则用上次的数据\n        ...pageInfoParams\n      });\n\n      setpaginationInfo({ current: formatParams.current, pageSize: formatParams.pageSize });\n      \n      // 判断排序参数是否传递给使用组件\n      // sorter: {\n      //  field: 'xxx',    // columns对应的dataIndex\n      //  order: 'ascend' | 'descend' }\n      if (!(sendSorter === undefined || Object.keys(sendSorter).length === 0 || sendSorter.order === undefined)) {\n        formatParams.sorter = sendSorter;\n      }\n      const { current: paramsCurrent, pageSize: paramsPageSize, sorter: sort, ...rest } = formatParams;\n      const requestParams: ListQueryRequestBody = {\n        pagination: { current: paramsCurrent, pageSize: paramsPageSize },\n        query: rest,\n      };\n\n      if (formatParams.sorter) {\n        requestParams.sort = {\n          type: formatParams.sorter.order,\n          key: formatParams.sorter.field\n        };\n      }\n\n      query(requestParams);\n      // 参数没传sorter时sorter为undefined，但页面的排序仍然为上次请求的状态，所以需加判断，sorter存在时再去设置\n      sorter && setsortColumns(sorter);\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  useImperativeHandle(ref, () => ({\n    query: search\n  }));\n\n  useEffect(() => {\n    !notQueryWhilestart && search({ ...defaultPaginetionInfo, ...initialValues });\n  }, []);\n\n\n  function handleReset() {\n    formRef.current?.resetFrom();\n    search({ current: 1 });\n  }\n\n  const paginationOnChange = (current: number, pageSize: number) => {\n    // 每页条数变化\n    if (pageSize !== paginationInfo.pageSize) {\n      search({ current: 1, pageSize });\n    } else {\n      search({ current, pageSize });\n    }\n  };\n\n  const tableChange = (pagination: any, filters: any, sorter: any) => {\n    const { field, order } = sorter;\n\n    if (field && (field !== (sortColumns ?? {}).field || order !== (sortColumns ?? {}).order)) {\n      search({}, { field, order });\n    }\n  };\n\n  return (\n    <div>\n      <div className={ styles.header }>\n        <FormRender ref={ formRef }\n          items={ formItem }\n          initialValues={ initialValues }\n          onPressEnter={ search }\n          formItemLayout={ props.formItemLayout || formItemLayout }\n        />\n        <div className={ styles.actions }>\n          {plusAction || <div />}\n          {formItem.length > 0 && (\n            <div>\n              <Button onClick={ handleReset } key=\"reset\" style={{ marginRight: '10px' }}>重置</Button>\n              <Button onClick={ () => search({ current: 1 }) } type=\"primary\" key=\"query\">查询</Button>\n            </div>\n          )}\n        </div>\n      </div>\n      <div className={ styles.body }>\n        {props.children ?? <Table bordered={ true }\n          size=\"small\"\n          dataSource={ list }\n          columns={ columns }\n          rowKey={ rowKey }\n          pagination={{\n            total,\n            showTotal: (totalCount: number) => `共${ totalCount }条数据`,\n            current: paginationInfo.current,\n            pageSize: paginationInfo.pageSize,\n            onChange: paginationOnChange,\n            showSizeChanger: true,\n            pageSizeOptions\n          }}\n          loading={ loading }\n          onChange={ tableChange }\n        />}\n      </div>\n    </div>\n  );\n  \n};\n\nexport default forwardRef(QueryTable);\n","import React, {\n  FC,\n  useCallback,\n  useState,\n  useRef,\n  useMemo,\n  useEffect,\n} from 'react';\nimport { Link } from 'umi';\nimport { Pagination, Spin, Empty } from 'antd';\nimport QueryTable, {\n  OnSearch,\n  Props as QueryTableProps,\n} from '@/components/QueryTable';\nimport { withAuthorized } from '@/utils/Authorized';\nimport { Role } from '@/utils/authority';\nimport DramaContentSearch from '@/components/DramaContentSearch';\nimport FilmContentSearch from '@/components/FilmContentSearch';\n\nimport {\n  CommentStatusMaps,\n  SortOptionsMaps,\n  isGoodCommentMaps,\n  subjectTypeMaps,\n} from '@/utils/constant';\nimport CommonItemWrap from '@/components/CommonItemWrap';\nimport style from './index.less';\n\nimport {\n  useGetCommontList,\n  useGetProductionGroupDetail,\n} from '@/services/publicServices';\nimport { CommontItem } from '@/types/types';\n\nconst PAGESIZE = 10;\nconst SORT_TYPE = 'desc';\nconst COMMENT_USER_RANK = 'common'; // 大众评论\n\nconst PublicCommentManage = (props: any) => {\n  const productionId = props?.location?.query?.dramaId || undefined;\n\n  const initSearch = {\n    pagination: { pageSize: PAGESIZE, current: 1 },\n    query: {\n      subjectId: productionId,\n      commentUserRank: COMMENT_USER_RANK,\n      checkStatus: undefined,\n      rootId: 0,\n    },\n    sort: {\n      key: 'createTime',\n      type: 'desc',\n    },\n  };\n\n  const [searchParams, setSearchParams] = useState(initSearch);\n  const {\n    commontList,\n    pagination,\n    CommontCount,\n    isValidating,\n    mutate,\n    isHighQuality,\n  } = useGetCommontList(searchParams);\n  const queryTable = useRef<any>();\n\n  const productionIds = useMemo(() => {\n    return (\n      commontList?.map((item: CommontItem) => {\n        return { subjectId: item?.subjectId, subjectType: item?.subjectType };\n      }) || []\n    );\n  }, [commontList]);\n  const { productionGroupDetail, detailLoading } = useGetProductionGroupDetail(\n    productionIds\n  );\n\n  const handleChangeSearch = useCallback(() => {\n    queryTable.current.query();\n  }, []);\n  const formItem: QueryTableProps['formItem'] = useMemo(\n    () => [\n      {\n        name: 'title',\n        label: '作品名称',\n        renderCom: (\n          <DramaContentSearch\n            onChange={handleChangeSearch}\n            style={{ width: '100%' }}\n          />\n        ),\n        span: 6,\n      },\n      {\n        name: 'filmTitle',\n        label: '片单名称',\n        renderCom: (\n          <FilmContentSearch\n            onChange={handleChangeSearch}\n            style={{ width: '100%' }}\n          />\n        ),\n        span: 6,\n      },\n\n      {\n        name: 'checkStatus',\n        span: 6,\n        label: '状态',\n        renderCom: 'select',\n        comProps: {\n          options: CommentStatusMaps,\n        },\n      },\n      {\n        name: 'isHighQuality',\n        span: 6,\n        label: '优质状态',\n        renderCom: 'select',\n        comProps: {\n          options: isGoodCommentMaps,\n        },\n      },\n      {\n        name: 'subjectType',\n        span: 6,\n        label: '主体类型',\n        renderCom: 'select',\n        comProps: {\n          options: subjectTypeMaps,\n        },\n      },\n      {\n        name: 'sort',\n        span: 5,\n        label: '排序字段',\n        renderCom: 'select',\n        comProps: {\n          options: SortOptionsMaps,\n        },\n      },\n    ],\n    [handleChangeSearch]\n  );\n\n  const handleSearch = useCallback(\n    (params: any) => {\n      const { pagination: page, query } = params;\n      console.log(query)\n\n      setSearchParams({\n        pagination: page,\n        query: {\n          subjectId: query?.title?.value || query?.filmTitle?.value || productionId,\n          commentUserRank: COMMENT_USER_RANK,\n          checkStatus: query?.checkStatus ? Number(query?.checkStatus) : undefined,\n          isHighQuality: query?.isHighQuality ? Number(query?.isHighQuality) : undefined,\n          rootId: 0,\n          subjectType: query?.subjectType || undefined,\n        },\n        sort: {\n          key: query?.sort || 'createTime',\n          type: 'desc',\n        },\n      });\n    },\n    [productionId]\n  );\n\n  const handleChangePage = useCallback((current: number, pageSize: number) => {\n    setSearchParams((lastestParams: any) => ({\n      ...lastestParams,\n      pagination: {\n        current,\n        pageSize,\n      },\n    }));\n  }, []);\n\n  const hiddenAddPraise = useMemo(() => {\n    return !productionId;\n  }, [productionId]);\n\n  useEffect(() => {\n    if (hiddenAddPraise) {\n      formItem.pop();\n    }\n  }, [formItem, hiddenAddPraise]);\n\n  return (\n    <div>\n      <QueryTable\n        notQueryWhilestart={true}\n        formItem={formItem}\n        query={handleSearch}\n        loading={isValidating}\n        ref={queryTable}\n        defaultPageSize={PAGESIZE}\n      >\n        <Spin tip=\"加载中...\" spinning={isValidating}>\n          {commontList?.length ? (\n            commontList?.map((item: CommontItem, index: number) => {\n              return (\n                <CommonItemWrap\n                  showBlackBtn={true}\n                  showProductionName={true}\n                  key={index}\n                  common={item}\n                  refresh={mutate}\n                  productionGroupDetail={productionGroupDetail}\n                  CommontCount={CommontCount}\n                  isHighQuality={isHighQuality}\n                  hiddenAddPraise={hiddenAddPraise}\n                />\n              );\n            })\n          ) : (\n            <Empty />\n          )}\n          <div className={style.footerPage}>\n            <Pagination\n              current={Number(pagination?.current || 1)}\n              pageSize={Number(pagination?.pageSize || 10)}\n              total={Number(pagination?.total || 0)}\n              showTotal={(total: number) => `总计 ${total} 条`}\n              showQuickJumper={true}\n              onChange={handleChangePage}\n            />\n          </div>\n        </Spin>\n      </QueryTable>\n    </div>\n  );\n};\n\nexport default withAuthorized(PublicCommentManage, [Role.SYSTEM, Role.COMMENT]);\n","var trim = require('../string/virtual/trim');\n\nvar StringPrototype = String.prototype;\n\nmodule.exports = function (it) {\n  var own = it.trim;\n  return typeof it === 'string' || it === StringPrototype\n    || (it instanceof String && own === StringPrototype.trim) ? trim : own;\n};\n","require('../../../modules/es.string.trim');\nvar entryVirtual = require('../../../internals/entry-virtual');\n\nmodule.exports = entryVirtual('String').trim;\n","var parent = require('../../es/instance/trim');\n\nmodule.exports = parent;\n","var fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]() || non[METHOD_NAME]() != non || whitespaces[METHOD_NAME].name !== METHOD_NAME;\n  });\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.es/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n"],"sourceRoot":""}