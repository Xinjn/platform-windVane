(globalThis["webpackChunkwindvane"]=globalThis["webpackChunkwindvane"]||[]).push([[4679],{54549:(e,n,t)=>{"use strict";t.d(n,{Z:()=>d});var a=t(67294),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"}}]},name:"close",theme:"outlined"};const s=o;var r=t(27029),i=function(e,n){return a.createElement(r.Z,Object.assign({},e,{ref:n,icon:s}))};i.displayName="CloseOutlined";const d=a.forwardRef(i)},8212:(e,n,t)=>{"use strict";t.d(n,{Z:()=>d});var a=t(67294),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"};const s=o;var r=t(27029),i=function(e,n){return a.createElement(r.Z,Object.assign({},e,{ref:n,icon:s}))};i.displayName="EditOutlined";const d=a.forwardRef(i)},13631:e=>{e.exports={productionManageWrap:"_zIPQ3R",productionManageChunk:"_166Lkj",lookMore:"_2gzmom"}},51691:(e,n,t)=>{"use strict";t.d(n,{Z:()=>h});t(13062);var a=t(71230),o=(t(89032),t(15746)),s=t(67294),r=t(96625),i=t(30381),d=t.n(i),l=t(8135),c=t.n(l),u=t(85893);const m=e=>{const n=e.production,t=void 0===n?{}:n,i=e.btnRender,l=e.imgSpan,m=e.detailSpan,h=e.btnSpan,v=(0,s.useMemo)((()=>{const e=null!==t&&void 0!==t&&t.coverImage?JSON.parse(null===t||void 0===t?void 0:t.coverImage):[];return null!==e&&void 0!==e&&e.length?e[0]:""}),[null===t||void 0===t?void 0:t.coverImage]);return(0,u.jsxs)(a.Z,{children:[(0,u.jsx)(o.Z,{span:null!==l&&void 0!==l?l:4,children:v?(0,u.jsx)("img",{className:c().productionImg,src:v}):""}),(0,u.jsxs)(o.Z,{span:(m||0)+(h||0)||20,className:c().productionInfo,children:[(0,u.jsxs)(a.Z,{children:[(0,u.jsxs)(o.Z,{span:m?m/20*24:10,children:[(0,u.jsx)("h3",{style:{marginBottom:14},children:null===t||void 0===t?void 0:t.title}),(0,u.jsxs)("p",{children:[(0,u.jsxs)("span",{className:c().productionInfoText,children:["\u54c1\u7c7b\uff1a",r.as[null===t||void 0===t?void 0:t.category]]}),(0,u.jsxs)("span",{children:["\u4e0a\u6620\u65f6\u95f4\uff1a",d()(null===t||void 0===t?void 0:t.showTime).format("YYYY-MM-DD")]})]})]}),(0,u.jsx)(o.Z,{span:h?h/20*24:14,style:{paddingLeft:30},children:i})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("p",{children:"\u7b80\u4ecb\uff1a"}),(0,u.jsx)("p",{style:{whiteSpace:"pre-line"},children:null===t||void 0===t?void 0:t.description})]})]})]})},h=m},41980:(e,n,t)=>{"use strict";t.d(n,{Z:()=>l});t(57663);var a=t(71577),o=(t(67294),t(2390)),s=t(8135),r=t.n(s),i=t(85893);const d=e=>{const n=e.title,t=e.enterUrl;return(0,i.jsxs)("p",{className:r().chunkTitle,children:[(0,i.jsx)("span",{className:r().chunkTitleText,children:n}),t?(0,i.jsx)(o.rU,{to:t,children:(0,i.jsx)(a.Z,{type:"primary",size:"small",children:"\u8fdb\u5165"})}):""]})},l=d},63987:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>ie});t(49111);var a=t(19650),o=(t(57663),t(71577)),s=t(95683),r=t.n(s),i=t(67294),d=t(2390),l=t(59867),c=t(7084),u=t(51691),m=t(41980),h=(t(20228),t(11382)),v=(t(13254),t(14277)),g=t(50047),p=t.n(g),x=t(13631),j=t.n(x),f=t(64074),w={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"};const b=w;var Z=t(27029),k=function(e,n){return i.createElement(Z.Z,Object.assign({},e,{ref:n,icon:b}))};k.displayName="RightOutlined";const y=i.forwardRef(k);var I=t(85893);const S=e=>{const n=e.title,t=e.enterUrl,a=e.commonList,o=e.loading,s=e.refresh,r=e.CommontCount,i=e.showBlackBtn;return(0,I.jsx)("div",{className:j().productionManageChunk,children:(0,I.jsxs)(h.Z,{tip:"\u52a0\u8f7d\u4e2d...",spinning:o,children:[(0,I.jsx)(m.Z,{title:n,enterUrl:t}),(0,I.jsx)("div",{children:null!==a&&void 0!==a&&a.length?null===a||void 0===a?void 0:p()(a).call(a,((e,n)=>(0,I.jsx)(f.Z,{showBlackBtn:i,common:e,CommontCount:r,refresh:s},n))):(0,I.jsx)(v.Z,{})}),(0,I.jsxs)(d.rU,{to:t,className:j().lookMore,children:[(0,I.jsx)("span",{children:"\u67e5\u770b\u66f4\u591a"}),(0,I.jsx)(y,{})]})]})})},C=S;var M=t(18598),T=t(33909),O=t(81500),N=t(90032),U=t(9257),L=(t(34792),t(78042)),$=t(20594),R=t(72709),z=t(80129),B=t(17778);function E(e){const n={code:200,level:200,message:"success",description:"",data:{dramaId:"6946047772109836387",enabledHighScoreAlarm:1,highScore:8.4,enabledLowScoreAlarm:1,lowScore:4.5,numberOfOpenDrama:100,operator:""},succeed:!0,msg:"success"},t=!1,a=()=>{};return{btnAuth:null===n||void 0===n?void 0:n.data,loading:t,mutate:a}}function A(e){return(0,R.ZP)(`${B.tW}/wingvate/wind-vane-backend/drama/operate/enabled/high-score/alarm?${(0,z.stringify)(e)}`,{method:"POST",body:e})}function H(e){return(0,R.ZP)(`${B.tW}/wingvate/wind-vane-backend/drama/operate/high-score/config?${(0,z.stringify)(e)}`,{method:"POST",body:e})}function P(e){return(0,R.ZP)(`${B.tW}/wingvate/wind-vane-backend/drama/operate/enabled/low-score/alarm?${(0,z.stringify)(e)}`,{method:"POST",body:e})}function W(e){return(0,R.ZP)(`${B.tW}/wingvate/wind-vane-backend/drama/operate/low-score/config?${(0,z.stringify)(e)}`,{method:"POST",body:e})}t(77883);var D=t(68470),Y=t(54549),V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"};const X=V;var _=function(e,n){return i.createElement(Z.Z,Object.assign({},e,{ref:n,icon:X}))};_.displayName="CheckOutlined";const q=i.forwardRef(_);var F=t(8212);const K=e=>{const n=e.score,t=e.onOk,a=e.type,o=(0,i.useState)(n),s=(0,$.Z)(o,2),r=s[0],d=s[1],l=(0,i.useState)(!1),c=(0,$.Z)(l,2),u=c[0],m=c[1];(0,i.useEffect)((()=>{d(n)}),[n]);const h=()=>{d(n),m(!1)},v=()=>{t(a,r),h()};return u?(0,I.jsx)(D.Z,{max:10,precision:1,addonBefore:(0,I.jsx)(Y.Z,{onClick:h}),onChange:d,addonAfter:(0,I.jsx)(q,{onClick:v}),value:r,style:{width:150}}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("span",{children:r}),(0,I.jsx)(F.Z,{onClick:()=>m(!0)})]})},G=K;t(62350);var J=t(75443);const Q=e=>{const n=e.dramaId,t=e.refresh,a=e.type,s=e.status,r=e.setInputNumloading,d=(0,i.useMemo)((()=>0===s?{revertStatus:1,revertStatusText:"\u5f00\u542f"}:{revertStatus:0,revertStatusText:"\u5173\u95ed"}),[s]),l=d.revertStatus,c=d.revertStatusText,u=(0,i.useCallback)((async()=>{let e,o="";switch(a){case"high":e=A,o="enabledHighScoreAlarm";break;case"low":e=P,o="enabledLowScoreAlarm";break}try{const s={dramaId:n,[o]:l};r((e=>({...e,[a]:!0})));const i=await e(s);200===(null===i||void 0===i?void 0:i.code)&&(L.default.success(`${c}\u9884\u8b66\u6210\u529f\uff01`),t())}catch(s){L.default.error((null===s||void 0===s?void 0:s.message)||"\u670d\u52a1\u5668\u51fa\u95ee\u9898\u5566")}finally{r((e=>({...e,[a]:!1})))}}),[a,n,l,r,c,t]),m=(0,i.useMemo)((()=>{switch(a){case"high":return"\u9ad8\u5206";case"low":return"\u4f4e\u5206"}}),[a]);return(0,I.jsx)(J.Z,{placement:"bottomRight",title:`\u786e\u8ba4${c}${m}\u9884\u8b66\u5417\uff1f`,onConfirm:u,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",children:(0,I.jsxs)(o.Z,{style:{marginTop:10},children:[c,m,"\u9884\u8b66"]})})},ee=Q,ne=e=>{const n=e.productionDetail,t=E(null===n||void 0===n?void 0:n.dramaId),o=t.btnAuth,s=t.loading,r=t.mutate,d=(0,i.useState)({high:!1,low:!1}),l=(0,$.Z)(d,2),c=l[0],u=l[1],m=(0,i.useCallback)((async(e,t)=>{try{let a,o;switch(e){case"high":a=H,o="highScore";break;case"low":a=W,o="lowScore";break}u((n=>({...n,[e]:!0})));const s=await a({dramaId:null===n||void 0===n?void 0:n.dramaId,[o]:t});200===(null===s||void 0===s?void 0:s.code)&&(L.default.success("\u8bbe\u7f6e\u6210\u529f\uff01"),r())}catch(a){L.default.error(null===a||void 0===a?void 0:a.message)}finally{u((n=>({...n,[e]:!1})))}}),[r,n]);return(0,I.jsx)(h.Z,{spinning:s,children:(0,I.jsxs)(a.Z,{size:30,children:[(0,I.jsxs)(h.Z,{spinning:null===c||void 0===c?void 0:c.high,children:[(0,I.jsx)(G,{score:(null===o||void 0===o?void 0:o.highScore)||0,type:"high",onOk:m}),(0,I.jsx)("br",{}),(0,I.jsx)(ee,{dramaId:null===n||void 0===n?void 0:n.dramaId,refresh:r,type:"high",status:null===o||void 0===o?void 0:o.enabledHighScoreAlarm,setInputNumloading:u})]}),(0,I.jsxs)(h.Z,{spinning:null===c||void 0===c?void 0:c.low,children:[(0,I.jsx)(G,{score:(null===o||void 0===o?void 0:o.lowScore)||0,type:"low",onOk:m}),(0,I.jsx)("br",{}),(0,I.jsx)(ee,{dramaId:null===n||void 0===n?void 0:n.dramaId,refresh:r,type:"low",status:null===o||void 0===o?void 0:o.enabledLowScoreAlarm,setInputNumloading:u})]})]})})},te=ne,ae=2,oe=(0,c.Cz)(),se={system:r()(oe).call(oe,c.uU.SYSTEM)>=0,works:r()(oe).call(oe,c.uU.WORKS)>=0,comment:r()(oe).call(oe,c.uU.COMMENT)>=0,expert:r()(oe).call(oe,c.uU.EXPERT)>=0},re=e=>{const n=e.match.params,t=(0,T.OL)(null===n||void 0===n?void 0:n.id),s=t.productionDetail,r=(t.detailLoading,t.mutate),l=(0,i.useMemo)((()=>({pagination:{pageSize:ae,current:1},query:{subjectId:null===n||void 0===n?void 0:n.id,commentUserRank:"expert",checkStatus:void 0,rootId:0}})),[null===n||void 0===n?void 0:n.id]),c=(0,i.useMemo)((()=>({pagination:{pageSize:ae,current:1},query:{subjectId:null===n||void 0===n?void 0:n.id,commentUserRank:"common",checkStatus:void 0,rootId:0}})),[null===n||void 0===n?void 0:n.id]),h=(0,T.Hm)(l),v=h.commontList,g=h.CommontCount,p=h.isValidating,x=h.mutate,f=(0,T.Hm)(c),w=f.commontList,b=f.CommontCount,Z=f.isValidating,k=f.mutate,y=()=>{r()};return(0,I.jsxs)("div",{className:j().productionManageWrap,children:[null!==se&&void 0!==se&&se.system||null!==se&&void 0!==se&&se.works?(0,I.jsxs)("div",{className:j().productionManageChunk,children:[(0,I.jsx)(m.Z,{title:"\u4f5c\u54c1\u8d44\u6599\u7ba1\u7406",enterUrl:`/content-manage/production-data?dramaId=${s.dramaId||111}`}),(0,I.jsx)(u.Z,{production:s,btnRender:(0,I.jsxs)(a.Z,{size:30,children:[(0,I.jsxs)("div",{children:[(0,I.jsx)(d.rU,{to:`/content-manage/production-data?dramaId=${s.dramaId||111}`,children:(0,I.jsx)(o.Z,{type:"primary",children:"\u4fee\u6539\u8d44\u6599"})}),(0,I.jsx)("br",{}),(0,I.jsx)(M.ZG,{style:{marginTop:10},production:s,refresh:r})]}),(0,I.jsx)(te,{productionDetail:s})]})})]}):null,null!==se&&void 0!==se&&se.system||null!==se&&void 0!==se&&se.comment?(0,I.jsx)(C,{title:"\u5927\u4f17\u8bc4\u8bba\u7ba1\u7406",showBlackBtn:!0,enterUrl:`/commont-manage/public-comment-manage?dramaId=${s.dramaId}`,commonList:w,CommontCount:b,loading:Z,refresh:k}):null,null!==se&&void 0!==se&&se.system||null!==se&&void 0!==se&&se.expert?(0,I.jsx)(C,{title:"\u4e13\u4e1a\u8bc4\u8bba\u7ba1\u7406",showBlackBtn:!1,enterUrl:`/commont-manage/expert-comment-manage?dramaId=${s.dramaId}`,CommontCount:g,commonList:v,loading:p,refresh:x}):null,(null===se||void 0===se?void 0:se.system)&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{className:j().productionManageChunk,children:[(0,I.jsx)(m.Z,{title:"\u8bc4\u5206\u4eba\u6570\u8c03\u63a7",enterUrl:`/data-manage/data-control?dramaId=${s.dramaId}`}),(0,I.jsx)(U.Z,{dramaInfo:s,successHandle:y})]}),(0,I.jsxs)("div",{className:j().productionManageChunk,children:[(0,I.jsx)(m.Z,{title:"\u6570\u636e\u8c03\u63a7",enterUrl:`/data-manage/data-control?dramaId=${s.dramaId}`}),(0,I.jsx)(O.Z,{dramaId:null===n||void 0===n?void 0:n.id,successHandle:y})]}),(0,I.jsxs)("div",{className:j().productionManageChunk,children:[(0,I.jsx)(m.Z,{title:"\u704c\u8bc4",enterUrl:`/data-manage/data-control?dramaId=${s.dramaId}`}),(0,I.jsx)(N.Z,{dramaId:null===n||void 0===n?void 0:n.id,successHandle:y})]})]})]})},ie=(0,l.IX)(re,[c.uU.SYSTEM,c.uU.WORKS,c.uU.COMMENT,c.uU.EXPERT])}}]);
//# sourceMappingURL=p__ContentManage__ProductionManage.172ccbe4.async.js.map