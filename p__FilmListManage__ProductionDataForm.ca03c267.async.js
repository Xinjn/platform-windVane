(globalThis["webpackChunkwindvane"]=globalThis["webpackChunkwindvane"]||[]).push([[6322],{54549:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(67294),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"}}]},name:"close",theme:"outlined"};const i=a;var l=n(27029),r=function(e,t){return s.createElement(l.Z,Object.assign({},e,{ref:t,icon:i}))};r.displayName="CloseOutlined";const o=s.forwardRef(r)},57119:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(67294),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};const i=a;var l=n(27029),r=function(e,t){return s.createElement(l.Z,Object.assign({},e,{ref:t,icon:i}))};r.displayName="ExclamationCircleOutlined";const o=s.forwardRef(r)},24357:e=>{e.exports={initCountWrap:"_17ms1R",productionDataFormWrap:"_1Fh5GP",titleWarm:"_3xBqgr",productionDataFormChunk:"_2Wik4D",addInitCount:"_ZjiDHz",btnList:"_thr1M7",btn:"_1N7ZX9",greenBtn:"_2hD2oj",productionDetail:"_2rD427",productionStatus:"_DRFlTl",productionIcon:"_U7SeT-",commontChunkWrap:"_1uJYfv",commontChunk:"_KnFKZw",commontItem:"_c5nFnf"}},86145:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});n(95300);var s=n(7277),a=n(21052),i=n.n(a),l=n(67294),r=n(30381),o=n.n(r),c=n(85893);const d=s.Z.Countdown,u=e=>{const t=o()(e).isAfter(o()())?o().duration(o()(e).diff(o()())):o().duration(o()().diff(o()(e)));let n=0;return n=i()(t.asHours()+""),{hours:n,days:`${i()(t.asDays()+"")}\u5929`}},m=({time:e,overTimeText:t="\u5df2\u8d85\u65f6",fontSize:n="14px",style:s={fontSize:"14px",color:"#1890ff"}})=>{const a=(0,l.useMemo)((()=>u(e)),[e]),i=a.hours,r=a.days;return(new Date).getTime()>=("number"===typeof e?e:o()(e).valueOf())?(0,c.jsx)("span",{style:{color:"#f81d22"},children:t}):i>=24?(0,c.jsx)("span",{style:s,children:r}):(0,c.jsx)(d,{value:e,valueStyle:s})},p=m},90032:(e,t,n)=>{"use strict";n.d(t,{Z:()=>U});n(89032);var s=n(15746),a=(n(13062),n(71230)),i=(n(71194),n(50146)),l=(n(20136),n(55241)),r=(n(43185),n(72587)),o=(n(47673),n(59193)),c=(n(57663),n(71577)),d=(n(77883),n(68470)),u=(n(34792),n(78042)),m=n(69417),p=n(20594),h=(n(9715),n(69733)),x=n(89356),v=n.n(x),g=n(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};const y=j;var f=n(27029),Z=function(e,t){return g.createElement(f.Z,Object.assign({},e,{ref:t,icon:y}))};Z.displayName="UploadOutlined";const b=g.forwardRef(Z);var w=n(81620),S=n.n(w),I=n(17778),k=n(36038),C=n(33909),T=n(86145),N=n(85893);const F=h.Z.Item,L={display:"inline-block",width:"24px",lineHeight:"32px",textAlign:"center"},O={display:"inline-block",marginBottom:"0"},z=e=>{const t=e.noAction,n=void 0!==t&&t,x=e.subjectType,j=void 0===x?"default":x,y=h.Z.useForm(),f=(0,p.Z)(y,1),Z=f[0],w=(0,g.useState)(!1),z=(0,p.Z)(w,2),U=z[0],D=z[1],P=(0,g.useState)({}),W=(0,p.Z)(P,2),q=W[0],A=W[1],$=(0,g.useState)({}),E=(0,p.Z)($,2),_=E[0],R=E[1],M=(0,g.useState)(!1),B=(0,p.Z)(M,2),V=B[0],H=B[1],G=(0,g.useState)(!1),J=(0,p.Z)(G,2),K=J[0],X=J[1],Y=(0,C.PL)(e.dramaId,j),Q=Y.adjustComment,ee=Y.mutate,te=(0,g.useState)(!1),ne=(0,p.Z)(te,2),se=ne[0],ae=ne[1];(0,g.useEffect)((()=>{0!==v()(Q||{}).length&&X(!0)}),[e.dramaId,Q.subjectId,Q.updateTime]);const ie=()=>{Z.validateFields().then((t=>{H(!0);const n=t.hour,s=t.minute,a=t.second,i=(0,m.Z)(t,["hour","minute","second"]),l={subjectId:e.dramaId,adjustTime:`${n}-${s}-${a}`,commentFileUrl:i.commentFileUrl,subjectType:(null===e||void 0===e?void 0:e.subjectType)||"default"};(0,k.Xl)(l).then((t=>{H(!1),200===t.code&&(u.default.success("\u64cd\u4f5c\u6210\u529f"),ee(),e.successHandle&&e.successHandle())})).catch((()=>{H(!1)}))})).catch((()=>{H(!1)}))},le=()=>{D(!0)},re=()=>{D(!1),q.commentFileUrl&&(ae(!0),R(q),Z.setFieldsValue({commentFileUrl:q.commentFileUrl}))},oe=()=>{_.commentFileUrl&&A(_),D(!1)},ce=({file:e})=>{const t=e.name,n=e.status,s=e.response;if("uploading"!==n){const e=s||{},n=e.message,a=e.success;a?A({name:t,commentFileUrl:n}):u.default.warn("\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\uff01")}};return(0,N.jsxs)(g.Fragment,{children:[(0,N.jsxs)(h.Z,{form:Z,children:[(0,N.jsxs)(F,{label:"\u704c\u8bc4\u65f6\u95f4",extra:K?(0,N.jsxs)("div",{children:["\u5269\u4f59\u65f6\u95f4\uff1a",(0,N.jsx)("span",{style:{display:"inline-block"},children:(0,N.jsx)(T.Z,{time:Q.adjustEndTime,overTimeText:"\u5df2\u8fc7\u671f",style:{color:"rgba(0, 0, 0, 0.45)",display:"inline-block",fontSize:"14px"}})})]}):"\u5269\u4f59\u65f6\u95f4",style:{marginBottom:0},children:[(0,N.jsx)(F,{style:O,name:"hour",rules:[{required:!0,message:"\u8be5\u9879\u5fc5\u8f93"}],children:(0,N.jsx)(d.Z,{step:1,min:0,style:{width:"120px"},placeholder:"\u5c0f\u65f6"})}),(0,N.jsx)("span",{style:L,children:":"}),(0,N.jsx)(F,{style:O,name:"minute",rules:[{required:!0,message:"\u8be5\u9879\u5fc5\u8f93"}],children:(0,N.jsx)(d.Z,{step:1,min:0,max:59,style:{width:"120px"},placeholder:"\u5206\u949f"})}),(0,N.jsx)("span",{style:L,children:":"}),(0,N.jsx)(F,{style:O,name:"second",rules:[{required:!0,message:"\u8be5\u9879\u5fc5\u8f93"}],children:(0,N.jsx)(d.Z,{step:1,min:0,max:59,style:{width:"120px"},placeholder:"\u79d2"})})]}),(0,N.jsx)(F,{label:"\u8bc4\u8bba\u6a21\u677f",children:(0,N.jsxs)("div",{style:{display:"inline-block",lineHeight:"32px"},children:[(0,N.jsx)(c.Z,{type:"link",onClick:le,style:{position:"relative",zIndex:10},children:"\u70b9\u51fb\u4e0a\u4f20\u6a21\u677f"}),_.commentFileUrl&&se&&(0,N.jsx)("a",{href:_.commentFileUrl,style:{display:"block",position:"relative",zIndex:10,marginLeft:"20px"},children:_.name}),(0,N.jsx)(F,{name:"commentFileUrl",style:{marginTop:"-30px",marginLeft:"20px"},rules:[{required:!0,message:"\u8bf7\u4e0a\u4f20\u6587\u4ef6"}],children:(0,N.jsx)(o.Z,{style:{display:"none"}})})]})})]}),(0,N.jsxs)(i.Z,{title:"\u4e0a\u4f20\u6587\u4ef6",width:400,visible:U,onOk:re,onCancel:oe,children:[(0,N.jsxs)("div",{style:{textAlign:"center"},children:["\u6dfb\u52a0\u5185\u5bb9\uff1a",(0,N.jsx)(r.Z,{showUploadList:!1,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",style:{marginLeft:"20px"},action:`${I.ZP}/Cmpp/runtime/upload!file.jhtml`,name:"filedata",data:{domain:"y0.ifengimg.com",syncflag:1},onChange:ce,children:(0,N.jsx)(c.Z,{type:"primary",icon:(0,N.jsx)(b,{}),children:"\u4e0a\u4f20\u6587\u4ef6"})}),q.commentFileUrl&&(0,N.jsx)("a",{href:q.commentFileUrl,style:{marginTop:"20px",display:"block"},children:q.name})]}),(0,N.jsxs)("div",{style:{textAlign:"center",marginTop:"20px"},children:["\u652f\u6301excel\u6587\u4ef6",(0,N.jsx)(l.Z,{placement:"bottom",content:(0,N.jsx)("img",{src:S(),style:{width:"300px"}}),children:(0,N.jsx)("span",{style:{color:"#008DFF",marginLeft:"30px"},children:"\u67e5\u770b\u6a21\u677f\u793a\u4f8b"})})]})]}),n?(0,N.jsx)(a.Z,{style:{color:"red"},children:"\u8bf7\u5148\u521b\u5efa\u7247\u5355\uff0c\u5728\u6dfb\u52a0\u704c\u8bc4\u54e6\uff01"}):(0,N.jsxs)(a.Z,{children:[(0,N.jsx)(s.Z,{children:(0,N.jsx)(c.Z,{onClick:()=>{Z.resetFields()},children:"\u91cd\u7f6e"})}),(0,N.jsx)(s.Z,{offset:2,children:(0,N.jsx)(c.Z,{type:"primary",onClick:ie,loading:V,children:"\u786e\u5b9a\u4fee\u6539"})})]})]})},U=z},11903:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});n(13254);var s=n(14277),a=n(20594),i=(n(43358),n(44477)),l=n(54579),r=n.n(l),o=n(50047),c=n.n(o),d=n(42825),u=n.n(d),m=n(67294),p=n(34165),h=n(85893);const x=i.Z.Option;let v;function g(e,t){function n(){(0,p.B)({title:e,onlineStatus:"1"}).then((e=>{var n;const s=(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.list)||[];t(s)}))}v&&(clearTimeout(v),v=null),v=r()(n,300)}const j=e=>{const t=e.value,n=e.onChange,l=e.width,r=(0,m.useState)([]),o=(0,a.Z)(r,2),d=o[0],p=o[1],v=e=>{e?g(e,(e=>p(e))):p([])},j=e=>{const t=e.value,s=JSON.parse(t),a=s.dramaId;n({...e,totalItem:t,value:a})};return(0,h.jsx)(i.Z,{showSearch:!0,labelInValue:!0,value:t,style:{width:l||"100%"},placeholder:"\u8f93\u5165\u540d\u79f0\u641c\u7d22\uff08\u6a21\u7cca\u641c\u7d22\uff09",defaultActiveFirstOption:!0,showArrow:!1,filterOption:!1,onSearch:v,onChange:j,notFoundContent:(0,h.jsx)(s.Z,{}),children:c()(d).call(d,(e=>(0,h.jsx)(x,{value:u()(e),children:e.title},e.dramaId)))})},y=j},34165:(e,t,n)=>{"use strict";n.d(t,{B:()=>i});var s=n(72709),a=n(17778);async function i(e){return await(0,s.ZP)(`${a.tW}/wingvate/wind-vane-backend/drama/query/queryDramaContentList`,{method:"POST",body:{query:e,sort:{type:"desc",key:"createTime"},pagination:{pageSize:100,current:1}}})}},41980:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});n(57663);var s=n(71577),a=(n(67294),n(2390)),i=n(8135),l=n.n(i),r=n(85893);const o=e=>{const t=e.title,n=e.enterUrl;return(0,r.jsxs)("p",{className:l().chunkTitle,children:[(0,r.jsx)("span",{className:l().chunkTitleText,children:t}),n?(0,r.jsx)(a.rU,{to:n,children:(0,r.jsx)(s.Z,{type:"primary",size:"small",children:"\u8fdb\u5165"})}):""]})},c=o},36038:(e,t,n)=>{"use strict";n.d(t,{Td:()=>l,Ep:()=>r,bN:()=>o,Xl:()=>c,Wj:()=>d});var s=n(72709),a=n(17778),i=n(96625);async function l(e){const t={code:200,level:200,message:"success",description:"",data:[{time:2022070415,count:1}],succeed:!0,msg:"success"};return t}async function r(e){return await(0,s.ZP)(`${a.tW}/wingvate/wind-vane-backend/statistics/public-score/trend/list`,{method:"POST",body:e})}async function o(e){return await(0,s.ZP)(`${a.tW}/comment/saveAndStartAdjust`,{method:"POST",body:e})}async function c(e){return await(0,s.ZP)(`${a.tW}/comment/saveAndStartCommentAdjust`,{method:"POST",body:{...e,appId:i.AF}})}async function d(e,t){return await(0,s.ZP)(`${a.tW}/comment/sampleAdjustGrade`,{method:"POST",body:e})}},48061:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Fe});n(13062);var s=n(71230),a=(n(89032),n(15746)),i=(n(62350),n(75443)),l=(n(57663),n(71577)),r=(n(88983),n(82530)),o=(n(22385),n(31097)),c=(n(71194),n(50146)),d=(n(34792),n(78042)),u=(n(9715),n(69733)),m=n(20594),p=(n(47673),n(59193)),h=n(95683),x=n.n(h),v=n(54579),g=n.n(v),j=n(42825),y=n.n(j),f=n(50047),Z=n.n(f),b=n(21052),w=n.n(b),S=n(98882),I=n.n(S),k=n(73662),C=n.n(k),T=n(67294),N=n(6800),F=n(73340),L=n(7084),O=n(59867),z=n(41980),U=n(24357),D=n.n(U),P=n(57119),W=n(94184),q=n.n(W),A=n(72709),$=n(17778);function E(e){return(0,A.ZP)(`${$.tW}/wingvate/wind-vane-backend/list/operate/createListContent`,{method:"POST",body:{...e}})}function _(e){return(0,A.ZP)(`${$.tW}/wingvate/wind-vane-backend/list/operate/updateListContent`,{method:"POST",body:{content:{...e},listId:e.productionId,operator:e.operator,uSource:"\u540e\u53f0"}})}var R=n(30381),M=n.n(R),B=n(83619),V=n(18598),H=(n(20228),n(11382)),G=(n(94233),n(51890)),J=n(71997),K=n.n(J),X=n(32779),Y=n(8274),Q=n(246),ee=n.n(Q),te=n(85893);const ne=p.Z.Search,se=r.ZP.Group,ae=20,ie="expert",le={pagination:{pageSize:ae,current:1},query:{roleType:ie,status:1},sort:{type:"desc",key:"create_time"}},re=e=>{const t=e.visible,n=e.setVisible,s=e.onChange,a=(0,T.useState)(le),i=(0,m.Z)(a,2),o=i[0],d=i[1],u=(0,T.useState)([]),p=(0,m.Z)(u,2),h=p[0],x=p[1],v=(0,T.useState)(!0),g=(0,m.Z)(v,2),j=g[0],y=g[1],f=(0,Y.h)(o),b=f.userList,w=f.pagination,S=f.isValidating,I=(f.mutate,(0,T.useState)()),k=(0,m.Z)(I,2),C=k[0],N=k[1];(0,T.useEffect)((()=>{null!==b&&void 0!==b&&b.length&&x((e=>[...e,...b]))}),[b]);const F=()=>{n(!1),s&&s(C)},L=()=>{n(!1)},O=e=>{x([]),d((t=>{const n=t.query;t.pagination;return{...t,query:{...n,nickName:e},pagination:{current:1,pageSize:null===w||void 0===w?void 0:w.pageSize}}}))},z=()=>{const e=o.query,t=o.pagination;if((null===t||void 0===t?void 0:t.current)*(null===w||void 0===w?void 0:w.pageSize)<(null===w||void 0===w?void 0:w.total)){let n=null===t||void 0===t?void 0:t.current;n+=1,d({...o,query:e,pagination:{current:n,pageSize:null===w||void 0===w?void 0:w.pageSize}})}else y(!1)},U=e=>t=>{N({id:t.target.value,name:e})};return(0,te.jsxs)(c.Z,{title:"\u8bf7\u9009\u62e9\u4e13\u5bb6",visible:t,onOk:F,onCancel:L,children:[(0,te.jsxs)("div",{style:{marginBottom:"10px"},children:["\u4e13\u5bb6\u9009\u62e9\uff1a",(0,te.jsx)(l.Z,{icon:(0,te.jsx)(X.Z,{}),type:"primary",shape:"circle",style:{marginLeft:"20px"},onClick:()=>{O("")}})]}),(0,te.jsxs)("div",{style:{border:"1px solid #ccc",padding:"20px 10px"},children:[(0,te.jsx)(ne,{style:{marginBottom:"20px"},onSearch:O}),(0,te.jsx)(H.Z,{spinning:S,children:(0,te.jsx)("div",{style:{height:"600px",overflow:"auto",padding:"2px 20px 10px"},children:(0,te.jsx)(ee(),{initialLoad:!1,pageStart:1,threshold:50,loadMore:z,hasMore:!S&&j,useWindow:!1,children:(0,te.jsx)(se,{children:Z()(h).call(h,(e=>(0,te.jsx)(r.ZP,{className:K().expertItemW,value:e.userId,onChange:U(e.nickName),children:(0,te.jsxs)("div",{className:K().expertItem,children:[(0,te.jsx)(G.C,{className:K().expertItemAvatar,src:e.userAvatar}),(0,te.jsx)("span",{children:e.nickName})]})},e.userId)))})})})})]})]})},oe=re;var ce=n(96625),de=n(11903),ue=(n(15594),n(50386)),me=n(32563),pe=n(83916),he=n(8806),xe=n(57865),ve=n(7145),ge=n.n(ve),je=n(54549);const ye="DraggableBodyRow",fe=({index:e,moveRow:t,className:n,style:s,...a})=>{const i=(0,T.useRef)(),l=(0,me.L)({accept:ye,collect:t=>{const n=t.getItem()||{},s=n.index;return s===e?{}:{isOver:t.isOver(),dropClassName:s<e?" drop-over-downward":" drop-over-upward"}},drop:n=>{t(n.index,e)}}),r=(0,m.Z)(l,2),o=r[0],c=o.isOver,d=o.dropClassName,u=r[1],p=(0,pe.c)({type:ye,item:{index:e},collect:e=>({isDragging:e.isDragging()})}),h=(0,m.Z)(p,2),x=h[1];return u(x(i)),(0,te.jsx)("tr",{ref:i,className:`${n}${c?d:""}`,style:{cursor:"move",...s},...a})},Ze=e=>{const t=e.list,n=e.setList,s=e.deleteFn,a=[{title:"\u4f4d\u7f6e",dataIndex:"index",key:"index",render:(e,t,n)=>(0,te.jsx)("span",{children:n+1})},{title:"\u4f5c\u54c1\u540d\u79f0",dataIndex:"title",key:"title"},{title:"\u64cd\u4f5c",dataIndex:"action",key:"action",render:(e,t,n)=>(0,te.jsx)(je.Z,{onClick:s(n)})}],i={body:{row:fe}},l=(0,T.useCallback)(((e,s)=>{const a=t[e];n(ge()(t,{$splice:[[e,1],[s,0,a]]}))}),[t]);return(0,te.jsx)(he.W,{backend:xe.PD,children:(0,te.jsx)(ue.Z,{rowKey:"dramaId",columns:a,dataSource:t,components:i,onRow:(e,t)=>({index:t,moveRow:l}),pagination:!1})})},be=Ze;var we=n(90032),Se=n(33909);const Ie=[{width:300,height:300,text:"\u7247\u5355\u56fe\u7247"}],ke={labelCol:{span:4},wrapperCol:{span:20}},Ce=p.Z.TextArea,Te=(0,L.Cz)(),Ne=(x()(Te).call(Te,L.uU.SYSTEM),e=>{var t;const n=u.Z.useForm(),h=(0,m.Z)(n,1),v=h[0],j=(0,T.useState)(),f=(0,m.Z)(j,2),b=(f[0],f[1]),S=(0,T.useState)(!1),k=(0,m.Z)(S,2),L=k[0],O=k[1],U=(0,T.useState)({userName:"",cUserId:"",operator:""}),W=(0,m.Z)(U,2),A=W[0],R=W[1],H=(0,$.j$)(),G=H.data,J=(0,T.useRef)(!0),K=(0,T.useState)(!1),X=(0,m.Z)(K,2),Y=X[0],Q=X[1],ee=(0,T.useState)(!1),ne=(0,m.Z)(ee,2),se=ne[0],ae=ne[1],ie=(0,T.useState)([]),le=(0,m.Z)(ie,2),re=le[0],ue=le[1],me=(0,T.useState)({}),pe=(0,m.Z)(me,2),he=pe[0],xe=pe[1],ve=(0,T.useMemo)((()=>{var t,n;return null===e||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.query)||void 0===n?void 0:n.dramaId}),[e]),ge=async()=>{const e=await(0,Se.vY)(ve);if(200==e.code){const t=e.data,n=t.dramas,s=void 0===n?[]:n,a=t.nickName,i=void 0===a?"":a,l=t.creatorId,r=void 0===l?"":l,o=t.operator;ue(s||[]),xe(t),R({userName:i,cUserId:r,operator:o})}};(0,T.useEffect)((()=>{ve&&ge()}),[e]);const je=(0,T.useMemo)((()=>{const e=ce.OS[null===he||void 0===he?void 0:he.onlineStatus]||"";return x()(e).call(e,"\u4e0a\u7ebf")>-1}),[he]),ye=()=>{N.m8.push("/content-manage/filmList-manage")},fe=()=>{let e=he.title,t=he.coverImageUrl,n=he.description,s=he.category,a=he.platform,i=he.showTime,l=he.topDeadline,r=he.finishTime,o=he.type,c=void 0===o?"1":o,d=he.dramas,u=void 0===d?[]:d,m=he.creatorId;const p=t?[t]:[];let h,x;u&&u.length>0?(h=u[0].dramaId,x=u[0].title):u=[],v.setFieldsValue({title:e,coverImage:null!==p&&void 0!==p&&p.length?[{uid:(new Date).getTime(),name:(new Date).getTime(),status:"done",url:p[0]}]:[],description:n,category:s,platform:a?JSON.parse(a):[],showTime:i&&M()(i),topDeadline:l&&M()(l),finishTime:r&&M()(r),type:c+"",dataList:{value:h,label:x},zhanghao:{id:m}}),b(he)};(0,T.useEffect)((()=>{null!==he&&void 0!==he&&he.listId&&fe()}),[null===he||void 0===he?void 0:he.listId]),(0,T.useEffect)((()=>{const e=g()((()=>{Q(!0)}),15e3);return()=>{clearTimeout(e)}}),[]);(0,T.useCallback)((()=>{const e=v.validateFields;e().then((e=>{var t,n;const s={...e};s.coverImage=null!==e&&void 0!==e&&null!==(t=e.coverImage)&&void 0!==t&&t.length?y()([null===e||void 0===e||null===(n=e.coverImage[0])||void 0===n?void 0:n.url]):y()([]),b(s)})).catch((e=>{console.log("formError",e)}))}),[v]);const Ze=(0,T.useCallback)((()=>{const e=v.validateFields;e().then((async e=>{var t;console.log(e);const n=e.title,s=e.coverImage,a=e.description,i=(e.dataList,e.zhanghao.id),l=e.type,r={creatorId:i,visibility:1,coverImageUrl:null!==s&&void 0!==s&&s.length?null===(t=s[0])||void 0===t?void 0:t.url:"",onlineStatus:2,dataList:Z()(re).call(re,((e,t)=>({dramaId:e.dramaId,position:t+1}))),description:a,title:n,type:w()(l),defaultFlag:0};console.log("params",r),O(!0);try{var o;let e={};var c;if(e=ve?await _({...he,...r,productionId:ve}):await E({...r}),200===(null===(o=e)||void 0===o?void 0:o.code))Q(!1),d.default.success("\u64cd\u4f5c\u6210\u529f\uff01"),ye();else d.default.error((null===(c=e)||void 0===c?void 0:c.message)||"\u670d\u52a1\u5668\u51fa\u95ee\u9898\u5566")}catch(u){d.default.error(null===u||void 0===u?void 0:u.message)}finally{O(!1)}})).catch((e=>{console.log("formError",e)}))}),[v,ve,je,he,re]),Te=()=>{ae(!0)},Ne=e=>{var t;const n=e.id,s=e.name;R({userName:s,cUserId:n,operator:(null===G||void 0===G||null===(t=G.data)||void 0===t?void 0:t.displayName)||""})},Fe=e=>{let t=e.totalItem;t=JSON.parse(t),ue((e=>I()(e).call(e,(e=>e.dramaId===t.dramaId))?(d.default.info("\u8be5\u4f5c\u54c1\u5df2\u5b58\u5728\u7247\u5355\u4e2d"),[...e]):[...e,{...t}]))},Le=e=>()=>{const t=[...re];C()(t).call(t,e,1),ue(t)},Oe=()=>{};return(0,te.jsxs)("div",{className:D().productionDataFormWrap,children:[(0,te.jsx)(F.NL,{when:Y,message:e=>!J.current||(c.Z.confirm({title:"\u5373\u5c06\u79bb\u5f00\u9875\u9762",content:"\u6b63\u5728\u7f16\u8f91\u4f5c\u54c1, \u786e\u8ba4\u79bb\u5f00\u5417",onOk:()=>{J.current=!1,N.m8.push(e.pathname)},onCancel:()=>{J.current=!0}}),!J.current)}),(0,te.jsxs)(s.Z,{children:[(0,te.jsx)(a.Z,{span:12,className:D().productionDataFormChunk,children:(0,te.jsxs)(u.Z,{...ke,form:v,initialValues:{type:"1"},children:[(0,te.jsx)(z.Z,{title:"\u7247\u5355\u8d44\u6599\u7ba1\u7406"}),(0,te.jsxs)("div",{className:D().productionDetail,children:[(0,te.jsx)(u.Z.Item,{label:"\u7247\u5355\u540d\u79f0",name:"title",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0!"}],children:(0,te.jsx)(p.Z,{style:{width:"80%"},placeholder:"\u7247\u5355\u540d\u79f0\uff0c\u6700\u957f18\u4e2a\u5b57",maxLength:18})}),(0,te.jsx)(u.Z.Item,{label:"\u7247\u5355\u7b80\u4ecb",name:"description",children:(0,te.jsx)(Ce,{rows:4,placeholder:"\u6700\u957f30\u4e2a\u5b57\u54e6\uff01",maxLength:30})}),ve?je?(0,te.jsx)("p",{className:D().productionStatus,children:(0,te.jsx)(V.vk,{})}):(0,te.jsx)("div",{className:D().productionStatus,children:(0,te.jsxs)(o.Z,{placement:"topRight",title:(0,te.jsx)("p",{style:{width:240},children:"\u4e0b\u7ebf\u4f5c\u54c1\u70b9\u51fb\u53d1\u5e03\u540e\u53ef\u91cd\u65b0\u5728\u524d\u53f0\u5c55\u793a"}),children:[(0,te.jsx)(V.bw,{}),(0,te.jsx)(P.Z,{className:D().productionIcon})]})}):null]}),(0,te.jsx)(u.Z.Item,{label:"\u7247\u5355\u56fe\u7247",name:"coverImage",valuePropName:"fileList",children:(0,te.jsx)(B.Z,{sizeOptions:Ie,isSingle:!0,listType:"picture-card"})}),(0,te.jsxs)(u.Z.Item,{label:"\u53d1\u5e03\u8d26\u53f7",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4e13\u5bb6\u8d26\u53f7!"}],children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("span",{children:A.userName})," ",(0,te.jsx)("a",{onClick:Te,children:"\u70b9\u51fb\u9009\u62e9\u53d1\u5e03\u8d26\u53f7"})]}),(0,te.jsx)(u.Z.Item,{name:"zhanghao",noStyle:!0,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8d26\u53f7!"}],children:(0,te.jsx)(oe,{visible:se,setVisible:ae,onChange:Ne})})]}),(0,te.jsx)(u.Z.Item,{label:"\u7247\u5355\u7c7b\u578b",name:"type",children:(0,te.jsx)(r.ZP.Group,{options:ce.o5,optionType:"button",disabled:!0})}),(0,te.jsx)(u.Z.Item,{label:"\u9009\u62e9\u4f5c\u54c1",name:"dataList",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4f5c\u54c1!"}],children:(0,te.jsx)(de.Z,{onChange:Fe,style:{width:200}})}),(0,te.jsx)(be,{list:re,setList:ue,deleteFn:Le}),!he.type||ce.lz[he.type]&&x()(t=ce.lz[he.type]).call(t,"\u7528\u6237")?(0,te.jsxs)("div",{className:D().btnList,children:[(0,te.jsx)(l.Z,{className:D().btn,onClick:ye,children:"\u53d6\u6d88"}),(0,te.jsx)(i.Z,{placement:"topRight",title:"\u786e\u8ba4\u53d1\u5e03\u8be5\u7247\u5355\u5417",onConfirm:Ze,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:(0,te.jsx)(l.Z,{loading:L,className:D().btn,type:"primary",children:ve&&!je?"\u91cd\u65b0\u4e0a\u7ebf":"\u53d1\u5e03"})})]}):null]})}),(0,te.jsx)(a.Z,{span:12,className:q()([D().productionDataFormChunk,D().commontChunkWrap]),children:(0,te.jsxs)("div",{className:D().commontChunk,children:[(0,te.jsx)(z.Z,{title:"\u7247\u5355\u704c\u8bc4"}),(0,te.jsx)(we.Z,{dramaId:ve,subjectType:"listContent",successHandle:Oe,noAction:!ve})]})})]})]})}),Fe=(0,O.IX)(Ne,[L.uU.SYSTEM,L.uU.WORKS])},81620:(e,t,n)=>{e.exports=n.p+"static/templete.92e9a642.png"}}]);
//# sourceMappingURL=p__FilmListManage__ProductionDataForm.ca03c267.async.js.map